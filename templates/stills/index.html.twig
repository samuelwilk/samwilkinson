{% extends 'base.html.twig' %}

{% block title %}Stills - Sam Wilkinson{% endblock %}

{% block description %}Photography collections and albums.{% endblock %}

{% block body_class %}accent-persimmon{% endblock %}

{% block body %}
<main class="relative bg-gradient-to-br from-paper via-bone to-daylight min-h-screen">
    {# Subtle paper grain #}
    <div class="fixed inset-0 opacity-[0.02] mix-blend-multiply pointer-events-none" style="background-image: url('data:image/svg+xml,%3Csvg width=\'400\' height=\'400\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cfilter id=\'grain\'%3E%3CfeTurbulence baseFrequency=\'1.5\' numOctaves=\'3\'/%3E%3C/filter%3E%3Crect width=\'400\' height=\'400\' filter=\'url(%23grain)\' opacity=\'0.5\'/%3E%3C/svg%3E');"></div>

    {# Header #}
    <div class="relative max-w-7xl mx-auto px-6 md:px-8 pt-32 pb-16">
        {# Title with museum label #}
        <div class="mb-4">
            <div class="text-xs font-mono uppercase tracking-[0.2em] text-cognac mb-3">Photography</div>
            <h1 class="font-display text-6xl md:text-7xl lg:text-8xl font-medium text-ink leading-[0.92]" style="letter-spacing: -0.02em;">
                Stills
            </h1>
        </div>

        {# Subtitle #}
        <div class="max-w-2xl">
            <div class="relative">
                {# Hairline detail #}
                <div class="absolute -left-6 top-3 w-4 h-px bg-persimmon/30"></div>
                <p class="text-xl md:text-2xl text-graphite leading-relaxed font-light">
                    Collections from travels, moments, and observations.
                </p>
            </div>
        </div>

        {% if collections|length > 0 %}
            {# Collection count #}
            <div class="mt-8 flex items-center gap-3">
                <div class="w-12 h-px bg-stone/30"></div>
                <div class="text-sm font-mono text-stone">
                    <span class="tabular-nums">{{ collections|length }}</span> {{ collections|length == 1 ? 'collection' : 'collections' }}
                </div>
                <div class="flex-1 h-px bg-stone/30"></div>
            </div>
        {% endif %}
    </div>

    {# Masonry Grid with Museum Aesthetic #}
    {% if collections|length > 0 %}
        <div class="relative max-w-7xl mx-auto px-6 md:px-8 pb-32">
            <div
                data-controller="stills-masonry"
                data-stills-masonry-columns-value="3"
                data-stills-masonry-gap-value="48"
                class="relative"
                style="position: relative;"
            >
                {% for collection in collections %}
                    {% set coverPhoto = collection.coverPhoto %}
                    {% if coverPhoto and coverPhoto.isPublished %}
                        {# Calculate deterministic rotation based on collection slug (simple hash) #}
                        {% set slugHash = (collection.slug|length * 7 + loop.index * 13) %}
                        {% set rotation = ((slugHash % 400) / 100 - 2.0) %}

                        <a
                            href="{{ path('app_stills_album', {slug: collection.slug}) }}"
                            data-stills-masonry-target="item"
                            data-aspect-ratio="{{ coverPhoto.aspectRatio ?? 1.5 }}"
                            class="group block bg-bone overflow-hidden transition-all duration-700 ease-out hover:-translate-y-1"
                            style="will-change: transform; transform: rotate({{ rotation }}deg); box-shadow: 0 4px 12px -2px rgba(0, 0, 0, 0.08), 0 2px 6px -1px rgba(0, 0, 0, 0.04);"
                        >
                            {# Image with museum label overlay #}
                            <div class="relative overflow-hidden" style="padding-bottom: {{ (1 / (coverPhoto.aspectRatio ?? 1.5)) * 100 }}%;">
                                <img
                                    data-src="{{ '/uploads/photos/' ~ coverPhoto.filename }}"
                                    alt="{{ collection.name }}"
                                    class="absolute inset-0 w-full h-full object-cover transition-all duration-700 ease-out"
                                    loading="lazy"
                                />

                                {# Subtle overlay on hover #}
                                <div class="absolute inset-0 bg-ink/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700 ease-out"></div>

                                {# Museum Label - Always visible #}
                                <div class="absolute bottom-0 left-0 bg-bone/90 backdrop-blur-sm px-4 py-3 border-l-[3px] border-persimmon transition-all duration-500 ease-out group-hover:bg-bone/95 group-hover:border-l-[4px]">
                                    {# Collection Name #}
                                    <h2 class="font-display text-lg md:text-xl font-medium text-ink leading-tight mb-1 transition-colors duration-300 ease-out group-hover:text-persimmon">
                                        {{ collection.name }}
                                    </h2>

                                    {# Location & Year #}
                                    <div class="flex items-center gap-2 text-xs font-mono text-graphite whitespace-nowrap">
                                        {% if collection.locationName %}
                                            <span>{{ collection.locationName }}</span>
                                        {% endif %}
                                        {% if collection.locationName and collection.startDate %}
                                            <span class="text-stone/50">â€¢</span>
                                        {% endif %}
                                        {% if collection.startDate %}
                                            <span class="tabular-nums">{{ collection.startDate|date('Y') }}</span>
                                        {% endif %}
                                    </div>

                                    {# Photo Count - Subtle #}
                                    <div class="mt-1.5 text-[10px] font-mono text-stone/60 uppercase tracking-wider">
                                        {{ collection.photoCount }} {{ collection.photoCount == 1 ? 'photograph' : 'photographs' }}
                                    </div>
                                </div>

                                {# Protected Badge - Top Right #}
                                {% if collection.isRestricted %}
                                    <div class="absolute top-3 right-3 bg-walnut/90 backdrop-blur-sm px-2.5 py-1.5 rounded-sm">
                                        <div class="flex items-center gap-1.5">
                                            <svg class="w-3 h-3 text-bone" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z" />
                                            </svg>
                                            <span class="text-[10px] font-mono text-bone uppercase tracking-wide">Private</span>
                                        </div>
                                    </div>
                                {% endif %}
                            </div>
                        </a>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    {% else %}
        {# Empty state #}
        <div class="relative max-w-2xl mx-auto px-6 md:px-8 pb-24 text-center">
            <div class="p-12 bg-bone/50 rounded-xl border border-stone/10">
                <svg class="w-16 h-16 text-stone/30 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
                </svg>
                <h2 class="font-display text-2xl text-ink mb-2">No Collections Yet</h2>
                <p class="text-stone">Photography collections will appear here.</p>
            </div>
        </div>
    {% endif %}
</main>
{% endblock %}
